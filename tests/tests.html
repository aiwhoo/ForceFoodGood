<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Mocha Tests</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/mocha/mocha.css" />
    <script src="../core/models/restaurantModel.js"></script>
    <script src="../core/models/ratingsModel.js"></script>
    <script src="../core/models/menuModel.js"></script>

</head>
<body>
<div id="mocha"></div>

<script src="https://unpkg.com/chai@4/chai.js"></script>
<script src="https://unpkg.com/mocha/mocha.js"></script>

<script class="mocha-init">
    mocha.setup("bdd");
    const expect = chai.expect;
    describe("Restaurant Rating System", function() {
        it("starts with zero ratings", function() {
            let restaurant1 = new RestaurantModel("Anish's Cat Cafe", "101 North Dupont Road");
            expect(restaurant1.reviews.length).to.equal(0);
        })
        it("average of no reviews is No Reviews Found", function() {
            let restaurant1 = new RestaurantModel("Anish's Cat Cafe", "101 North Dupont Road");
            expect(restaurant1.calculateAverageReviewRating()).to.equal("No Review Found");
        })
        it("average of no reviews is No Reviews Found", function() {
            let restaurant1 = new RestaurantModel("Anish's Cat Cafe", "101 North Dupont Road");
            let review1 = new RatingModel(4, "Matt", "Today", "hello world");
            restaurant1.addReview(review1);
            expect(restaurant1.calculateAverageReviewRating()).to.equal(4);
        })
    })

    describe("Menu System", function() {
        it("starts with zero items", function() {
            let menu = new MenuModel("Dinner Menu");
            expect(menu.getItems().length).to.equal(0);
        })
        it("can add an item to the menu", function() {
            let menu = new MenuModel("Dinner Menu");
            let item = new MenuItem("Burger", 9.99, "A juicy beef burger", "Mains");
            menu.addItem(item);
            expect(menu.getItems().length).to.equal(1);
        })
        it("can remove an item from the menu", function() {
            let menu = new MenuModel("Dinner Menu");
            let item = new MenuItem("Burger", 9.99, "A juicy beef burger", "Mains");
            menu.addItem(item);
            menu.removeItem("Burger");
            expect(menu.getItems().length).to.equal(0);
        })
        it("can get items filtered by category", function() {
            let menu = new MenuModel("Dinner Menu");
            menu.addItem(new MenuItem("Burger", 9.99, "A juicy beef burger", "Mains"));
            menu.addItem(new MenuItem("Fries", 3.99, "Crispy fries", "Sides"));
            menu.addItem(new MenuItem("Steak", 24.99, "Grilled sirloin", "Mains"));
            expect(menu.getItemsByCategory("Mains").length).to.equal(2);
        })
        it("throws an error when removing an item that does not exist", function() {
            let menu = new MenuModel("Dinner Menu");
            expect(() => menu.removeItem("Pizza")).to.throw("Item not found in menu");
        })
        it("throws an error when creating a MenuItem with a negative price", function() {
            expect(() => new MenuItem("Bad Item", -1, "desc", "Mains")).to.throw("Price must be 0 or greater");
        })
    })
</script>
<script src="test.array.js"></script>
<script src="test.object.js"></script>
<script src="test.xhr.js"></script>
<script class="mocha-exec">
    mocha.run();
</script>
</body>
</html>